{
  "hash": "a83c9a8489bac24fc022f49f9c204b49",
  "result": {
    "markdown": "---\ntitle: \"Merging ADAPT and BT counts\"\nauthor: \"Karanvir Singh\"\ndate: \"2023-03-23\"\noutput: html_document\nexecute:\n  freeze: true  # never re-render during project render\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import BT and ADAPT per image counts\nADAPT_per_image <- read.csv(\"../../Final_Data/ADAPT_per_image_counts.csv\")\nglimpse(ADAPT_per_image)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,894\nColumns: 26\n$ Image            <chr> \"HGS_A_4_Scan1_Core[1,1,B]_[3937,39813]_component_dat…\n$ CD3pCD8nPD1n_S   <int> 43, 174, 0, 13, 4, 19, 49, 216, 0, 2, 15, 30, 12, 7, …\n$ CD3pCD8nPD1n_E   <int> 27, 70, 0, 19, 9, 5, 25, 29, 1, 1, 12, 50, 24, 7, 15,…\n$ CD3pCD8nPD1p_S   <int> 5, 52, 0, 3, 0, 4, 12, 123, 0, 0, 2, 80, 0, 0, 0, 27,…\n$ CD3pCD8nPD1p_E   <int> 4, 20, 0, 2, 4, 1, 1, 9, 2, 0, 6, 65, 2, 2, 5, 3, 0, …\n$ CD3pCD8pPD1n_S   <int> 33, 7, 0, 8, 4, 6, 27, 88, 0, 0, 2, 33, 2, 2, 0, 336,…\n$ CD3pCD8pPD1n_E   <int> 16, 5, 1, 18, 44, 7, 23, 36, 1, 0, 0, 203, 1, 2, 12, …\n$ CD3pCD8pPD1p_S   <int> 7, 4, 0, 4, 0, 1, 8, 83, 0, 1, 1, 193, 0, 0, 0, 103, …\n$ CD3pCD8pPD1p_E   <int> 1, 6, 0, 12, 40, 5, 2, 34, 4, 0, 2, 225, 0, 0, 3, 39,…\n$ CD68nPDL1nPD1p_S <int> 2, 5, 4, 1, 0, 2, 4, 163, 2, 0, 1, 26, 0, 0, 0, 13, 2…\n$ CD68nPDL1nPD1p_E <int> 2, 3, 13, 4, 5, 6, 12, 22, 14, 0, 7, 59, 1, 0, 12, 1,…\n$ area_mm2_S       <dbl> 0.0398304, 0.2006432, 0.0982136, 0.0364687, 0.0181770…\n$ area_mm2_E       <dbl> 0.3308669, 0.2030755, 0.0765365, 0.3187362, 0.3807839…\n$ TMA              <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\"…\n$ Sector           <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Row              <int> 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,…\n$ Column           <chr> \"B\", \"C\", \"D\", \"F\", \"G\", \"H\", \"I\", \"J\", \"B\", \"C\", \"D\"…\n$ tma_seC_row_col  <chr> \"A_1_1_B\", \"A_1_1_C\", \"A_1_1_D\", \"A_1_1_F\", \"A_1_1_G\"…\n$ pNum             <int> 664, 89, 107, 215, 330, 391, 892, 429, 601, 103, 457,…\n$ total_area       <dbl> 0.3706973, 0.4037187, 0.1747501, 0.3552049, 0.3989609…\n$ CD68pPDL1n_S     <int> 30, 113, 12, 71, 0, 45, 97, 132, 0, 6, 61, 24, 64, 18…\n$ CD68pPDL1n_E     <int> 92, 205, 12, 196, 62, 30, 150, 17, 3, 120, 180, 59, 1…\n$ CD68pPDL1p_S     <int> 3, 128, 0, 46, 9, 11, 3, 181, 2, 29, 34, 167, 39, 1, …\n$ CD68pPDL1p_E     <int> 30, 264, 0, 15, 82, 3, 29, 21, 3, 43, 49, 82, 49, 4, …\n$ PDL1pCKp_S       <int> 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,…\n$ PDL1pCKp_E       <int> 0, 68, 0, 0, 2, 0, 0, 0, 0, 9, 0, 1, 0, 0, 0, 0, 0, 0…\n```\n:::\n\n```{.r .cell-code}\nBT_per_image <- read.csv(\"../../Final_Data/BT_per_image_counts.csv\")[,-1]\nglimpse(BT_per_image)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,994\nColumns: 22\n$ Image            <chr> \"HGS_A_4_B+T_Scan1_Core[1,1,B]_[4615,44342]_component…\n$ CD3pCD8n_t       <int> 3, 6, 23, 15, 0, 0, 2, 18, 1, 0, 3, 35, 2, 1, 3, 0, 0…\n$ CD3pCD8n_s       <int> 44, 3, 49, 62, 1, 0, 1, 6, 147, 5, 7, 32, 8, 1, 6, 7,…\n$ CD3pCD8nFoxP3p_t <int> 0, 14, 0, 19, 0, 0, 1, 8, 2, 0, 5, 39, 2, 2, 0, 0, 0,…\n$ CD3pCD8nFoxP3p_s <int> 3, 2, 15, 84, 0, 0, 0, 1, 88, 5, 6, 16, 2, 5, 4, 3, 0…\n$ CD3pCD8p_t       <int> 19, 91, 18, 157, 0, 4, 0, 14, 8, 1, 18, 98, 0, 6, 2, …\n$ CD3pCD8p_s       <int> 47, 10, 39, 67, 0, 3, 0, 5, 154, 12, 35, 51, 5, 1, 9,…\n$ area_mm2_t       <dbl> 0.3646832, 0.3635600, 0.2753643, 0.2088972, 0.1503123…\n$ area_mm2_s       <dbl> 0.1108339, 0.0522965, 0.1711708, 0.1609591, 0.1873150…\n$ CD20p_t          <int> 0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0,…\n$ CD20p_s          <int> 0, 1, 9, 0, 1, 0, 0, 0, 32, 1, 0, 5, 0, 0, 0, 0, 0, 0…\n$ CD3pCD8pFoxP3p_t <int> 0, 2, 0, 6, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,…\n$ CD3pCD8pFoxP3p_s <int> 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ CD79ApCD20n_t    <int> 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 4, 8, 3, 0, 0, 0, 0,…\n$ CD79ApCD20n_s    <int> 0, 1, 3, 221, 0, 2, 0, 0, 34, 2, 1, 54, 3, 1, 11, 0, …\n$ TMA              <chr> \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"A\"…\n$ Sector           <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ Row              <int> 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4,…\n$ Column           <chr> \"B\", \"G\", \"I\", \"J\", \"A\", \"B\", \"C\", \"J\", \"A\", \"C\", \"D\"…\n$ tma_sec_row_col  <chr> \"A_1_1_B\", \"A_1_1_G\", \"A_1_1_I\", \"A_1_1_J\", \"A_1_2_A\"…\n$ pNum             <int> 664, 330, 892, 429, 525, 601, 103, 9, 323, 437, 492, …\n$ total_area       <dbl> 0.4755171, 0.4158565, 0.4465351, 0.3698563, 0.3376273…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardize suffixes so all epithelial columns have _E and stromal have _S\ncolnames(BT_per_image) <- gsub(\"_t\", \"_E\", colnames(BT_per_image)) %>%\n  gsub(\"_s\", \"_S\", .)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Patient summary (add all counts and area measurements across cores for the same patient)\nADAPT_per_patient <- ADAPT_per_image %>% group_by(pNum) %>% select(-contains(c(\"Sector\", \"Row\",\"Column\",\"TMA\", \"Detections\"))) %>%\n  summarise(across(where(is.numeric), ~sum(.x, na.rm=TRUE)))\nglimpse(ADAPT_per_patient)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,077\nColumns: 20\n$ pNum             <int> 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ CD3pCD8nPD1n_S   <int> 22, 0, 19, 1, 31, 13, 0, 0, 3, 42, 21, 13, 2, 3, 8, 5…\n$ CD3pCD8nPD1n_E   <int> 1, 0, 22, 1, 27, 8, 18, 1, 0, 0, 2, 36, 2, 0, 10, 6, …\n$ CD3pCD8nPD1p_S   <int> 23, 0, 59, 0, 18, 3, 0, 0, 0, 86, 29, 22, 0, 3, 1, 1,…\n$ CD3pCD8nPD1p_E   <int> 2, 1, 13, 0, 10, 1, 6, 0, 0, 1, 8, 24, 0, 0, 3, 0, 10…\n$ CD3pCD8pPD1n_S   <int> 5, 0, 24, 0, 10, 42, 0, 0, 2, 47, 18, 35, 1, 1, 2, 12…\n$ CD3pCD8pPD1n_E   <int> 0, 4, 15, 0, 7, 69, 12, 0, 1, 0, 5, 200, 0, 1, 4, 3, …\n$ CD3pCD8pPD1p_S   <int> 4, 0, 50, 0, 5, 14, 0, 0, 2, 78, 36, 27, 0, 0, 2, 0, …\n$ CD3pCD8pPD1p_E   <int> 4, 14, 28, 0, 11, 26, 4, 0, 0, 1, 2, 86, 0, 0, 2, 2, …\n$ CD68nPDL1nPD1p_S <int> 32, 0, 147, 2, 6, 0, 0, 0, 1, 312, 31, 112, 3, 5, 1, …\n$ CD68nPDL1nPD1p_E <int> 3, 1, 24, 1, 7, 1, 12, 0, 16, 2, 14, 27, 2, 17, 9, 5,…\n$ area_mm2_S       <dbl> 0.2547233, 0.0083039, 0.2807866, 0.2022337, 0.1164539…\n$ area_mm2_E       <dbl> 0.3355177, 0.3397186, 0.3017874, 0.3333567, 0.5991730…\n$ total_area       <dbl> 0.5902410, 0.3480225, 0.5825740, 0.5355904, 0.7156269…\n$ CD68pPDL1n_S     <int> 207, 5, 185, 41, 77, 103, 3, 4, 155, 163, 216, 84, 84…\n$ CD68pPDL1n_E     <int> 47, 127, 154, 2, 360, 320, 114, 20, 62, 10, 93, 135, …\n$ CD68pPDL1p_S     <int> 10, 1, 43, 6, 350, 211, 17, 2, 15, 19, 92, 114, 16, 0…\n$ CD68pPDL1p_E     <int> 0, 39, 1, 0, 292, 48, 70, 1, 1, 0, 8, 57, 1, 0, 1, 27…\n$ PDL1pCKp_S       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1,…\n$ PDL1pCKp_E       <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 108, 0, …\n```\n:::\n\n```{.r .cell-code}\nBT_per_patient <- BT_per_image %>% group_by(pNum) %>% select(-contains(c(\"Sector\", \"Row\",\"Column\",\"TMA\", \"Detections\"))) %>%\n  summarise(across(where(is.numeric), ~sum(.x, na.rm=TRUE)))\nglimpse(BT_per_patient)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,090\nColumns: 16\n$ pNum             <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…\n$ CD3pCD8n_E       <int> 2, 0, 4, 0, 3, 12, 0, 1, 19, 1, 0, 11, 2, 52, 0, 4, 1…\n$ CD3pCD8n_S       <int> 22, 0, 15, 0, 15, 5, 6, 33, 6, 0, 2, 147, 20, 61, 2, …\n$ CD3pCD8nFoxP3p_E <int> 5, 7, 37, 0, 2, 23, 2, 1, 9, 0, 0, 1, 1, 66, 0, 1, 3,…\n$ CD3pCD8nFoxP3p_S <int> 23, 0, 38, 0, 9, 10, 0, 4, 1, 0, 0, 22, 12, 11, 0, 2,…\n$ CD3pCD8p_E       <int> 5, 20, 44, 0, 4, 20, 105, 22, 17, 1, 1, 7, 7, 273, 1,…\n$ CD3pCD8p_S       <int> 8, 1, 63, 2, 23, 19, 29, 61, 6, 0, 3, 196, 38, 119, 1…\n$ area_mm2_E       <dbl> 0.4120475, 0.3123235, 0.2967971, 0.3529410, 0.0138621…\n$ area_mm2_S       <dbl> 0.3318424, 0.0932541, 0.4454908, 0.3709558, 0.2521645…\n$ CD20p_E          <int> 0, 1, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 17, 0, 0, 0, 0…\n$ CD20p_S          <int> 0, 1, 2, 0, 3, 0, 0, 1, 0, 0, 0, 13, 0, 29, 0, 1, 0, …\n$ CD3pCD8pFoxP3p_E <int> 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 3, 0, 0, 0, 0,…\n$ CD3pCD8pFoxP3p_S <int> 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0,…\n$ CD79ApCD20n_E    <int> 0, 0, 17, 0, 3, 1, 0, 0, 0, 0, 0, 2, 0, 66, 0, 1, 0, …\n$ CD79ApCD20n_S    <int> 11, 0, 249, 0, 8, 29, 0, 1, 0, 0, 0, 340, 2, 354, 0, …\n$ total_area       <dbl> 0.7438899, 0.4055776, 0.7422879, 0.7238968, 0.2660266…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine panels and save\nCOMBINED_PANEL_INNER_JOIN <- inner_join(ADAPT_per_patient, BT_per_patient, by=\"pNum\", suffix = c(\".ADAPT\", \".BT\"))\nglimpse(COMBINED_PANEL_INNER_JOIN)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,064\nColumns: 35\n$ pNum             <int> 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ CD3pCD8nPD1n_S   <int> 22, 0, 19, 1, 31, 13, 0, 0, 3, 42, 21, 13, 2, 3, 8, 5…\n$ CD3pCD8nPD1n_E   <int> 1, 0, 22, 1, 27, 8, 18, 1, 0, 0, 2, 36, 2, 0, 10, 6, …\n$ CD3pCD8nPD1p_S   <int> 23, 0, 59, 0, 18, 3, 0, 0, 0, 86, 29, 22, 0, 3, 1, 1,…\n$ CD3pCD8nPD1p_E   <int> 2, 1, 13, 0, 10, 1, 6, 0, 0, 1, 8, 24, 0, 0, 3, 0, 10…\n$ CD3pCD8pPD1n_S   <int> 5, 0, 24, 0, 10, 42, 0, 0, 2, 47, 18, 35, 1, 1, 2, 12…\n$ CD3pCD8pPD1n_E   <int> 0, 4, 15, 0, 7, 69, 12, 0, 1, 0, 5, 200, 0, 1, 4, 3, …\n$ CD3pCD8pPD1p_S   <int> 4, 0, 50, 0, 5, 14, 0, 0, 2, 78, 36, 27, 0, 0, 2, 0, …\n$ CD3pCD8pPD1p_E   <int> 4, 14, 28, 0, 11, 26, 4, 0, 0, 1, 2, 86, 0, 0, 2, 2, …\n$ CD68nPDL1nPD1p_S <int> 32, 0, 147, 2, 6, 0, 0, 0, 1, 312, 31, 112, 3, 5, 1, …\n$ CD68nPDL1nPD1p_E <int> 3, 1, 24, 1, 7, 1, 12, 0, 16, 2, 14, 27, 2, 17, 9, 5,…\n$ area_mm2_S.ADAPT <dbl> 0.2547233, 0.0083039, 0.2807866, 0.2022337, 0.1164539…\n$ area_mm2_E.ADAPT <dbl> 0.3355177, 0.3397186, 0.3017874, 0.3333567, 0.5991730…\n$ total_area.ADAPT <dbl> 0.5902410, 0.3480225, 0.5825740, 0.5355904, 0.7156269…\n$ CD68pPDL1n_S     <int> 207, 5, 185, 41, 77, 103, 3, 4, 155, 163, 216, 84, 84…\n$ CD68pPDL1n_E     <int> 47, 127, 154, 2, 360, 320, 114, 20, 62, 10, 93, 135, …\n$ CD68pPDL1p_S     <int> 10, 1, 43, 6, 350, 211, 17, 2, 15, 19, 92, 114, 16, 0…\n$ CD68pPDL1p_E     <int> 0, 39, 1, 0, 292, 48, 70, 1, 1, 0, 8, 57, 1, 0, 1, 27…\n$ PDL1pCKp_S       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1,…\n$ PDL1pCKp_E       <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 108, 0, …\n$ CD3pCD8n_E       <int> 2, 0, 4, 0, 12, 0, 19, 1, 0, 11, 2, 52, 0, 4, 15, 1, …\n$ CD3pCD8n_S       <int> 22, 0, 15, 0, 5, 6, 6, 0, 2, 147, 20, 61, 2, 6, 13, 2…\n$ CD3pCD8nFoxP3p_E <int> 5, 7, 37, 0, 23, 2, 9, 0, 0, 1, 1, 66, 0, 1, 3, 1, 3,…\n$ CD3pCD8nFoxP3p_S <int> 23, 0, 38, 0, 10, 0, 1, 0, 0, 22, 12, 11, 0, 2, 3, 3,…\n$ CD3pCD8p_E       <int> 5, 20, 44, 0, 20, 105, 17, 1, 1, 7, 7, 273, 1, 5, 14,…\n$ CD3pCD8p_S       <int> 8, 1, 63, 2, 19, 29, 6, 0, 3, 196, 38, 119, 1, 6, 5, …\n$ area_mm2_E.BT    <dbl> 0.4120475, 0.3123235, 0.2967971, 0.3529410, 0.5621711…\n$ area_mm2_S.BT    <dbl> 0.3318424, 0.0932541, 0.4454908, 0.3709558, 0.1531451…\n$ CD20p_E          <int> 0, 1, 2, 0, 2, 0, 0, 0, 0, 0, 0, 17, 0, 0, 0, 0, 1, 1…\n$ CD20p_S          <int> 0, 1, 2, 0, 0, 0, 0, 0, 0, 13, 0, 29, 0, 1, 0, 1, 0, …\n$ CD3pCD8pFoxP3p_E <int> 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0,…\n$ CD3pCD8pFoxP3p_S <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1,…\n$ CD79ApCD20n_E    <int> 0, 0, 17, 0, 1, 0, 0, 0, 0, 2, 0, 66, 0, 1, 0, 1, 3, …\n$ CD79ApCD20n_S    <int> 11, 0, 249, 0, 29, 0, 0, 0, 0, 340, 2, 354, 0, 1, 0, …\n$ total_area.BT    <dbl> 0.7438899, 0.4055776, 0.7422879, 0.7238968, 0.7153162…\n```\n:::\n\n```{.r .cell-code}\n#Calculate stroma proportion\nCOMBINED_PANEL_INNER_JOIN <- COMBINED_PANEL_INNER_JOIN %>% mutate(BT_str_prop = (area_mm2_S.BT/total_area.BT)*100,\n                                                                  BT_epi_prop = (area_mm2_E.BT/total_area.BT)*100,\n                                                                  ADAPT_epi_prop = (area_mm2_E.ADAPT/total_area.ADAPT)*100,\n                                                                  ADAPT_str_prop = (area_mm2_S.ADAPT/total_area.ADAPT)*100) %>%\n  mutate(avg_str_prop = (BT_str_prop+ADAPT_str_prop)/2,\n         avg_epi_prop = (BT_epi_prop+ADAPT_epi_prop)/2)\n\n\n# Write file\n# COMBINED_PANEL_INNER_JOIN %>% write.csv(\"final_data/COMBINED_PANELS_COUNTS_08NOV22.csv\", row.names = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Densities\nBT_per_patient_densities <- BT_per_patient %>% mutate(across(ends_with(\"_S\") & -area_mm2_E & -area_mm2_S & -total_area, ~ .x/area_mm2_S)) %>%\n  mutate(across(ends_with(\"_E\") & -area_mm2_E & -area_mm2_S & -total_area, ~.x/area_mm2_E))\n\nglimpse(BT_per_patient_densities)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,090\nColumns: 16\n$ pNum             <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…\n$ CD3pCD8n_E       <dbl> 4.853809, 0.000000, 13.477221, 0.000000, 216.417426, …\n$ CD3pCD8n_S       <dbl> 66.296531, 0.000000, 33.670729, 0.000000, 59.484979, …\n$ CD3pCD8nFoxP3p_E <dbl> 12.134523, 22.412659, 124.664291, 0.000000, 144.27828…\n$ CD3pCD8nFoxP3p_S <dbl> 69.310010, 0.000000, 85.299180, 0.000000, 35.690987, …\n$ CD3pCD8p_E       <dbl> 12.134523, 64.036168, 148.249427, 0.000000, 288.55656…\n$ CD3pCD8p_S       <dbl> 24.107829, 10.723389, 141.417062, 5.391478, 91.210301…\n$ area_mm2_E       <dbl> 0.4120475, 0.3123235, 0.2967971, 0.3529410, 0.0138621…\n$ area_mm2_S       <dbl> 0.3318424, 0.0932541, 0.4454908, 0.3709558, 0.2521645…\n$ CD20p_E          <dbl> 0.000000, 3.201808, 6.738610, 0.000000, 0.000000, 3.5…\n$ CD20p_S          <dbl> 0.000000, 10.723389, 4.489431, 0.000000, 11.896996, 0…\n$ CD3pCD8pFoxP3p_E <dbl> 0.000000, 0.000000, 3.369305, 0.000000, 0.000000, 0.0…\n$ CD3pCD8pFoxP3p_S <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 6.5…\n$ CD79ApCD20n_E    <dbl> 0.000000, 0.000000, 57.278188, 0.000000, 216.417426, …\n$ CD79ApCD20n_S    <dbl> 33.148266, 0.000000, 558.934101, 0.000000, 31.725322,…\n$ total_area       <dbl> 0.7438899, 0.4055776, 0.7422879, 0.7238968, 0.2660266…\n```\n:::\n\n```{.r .cell-code}\nADAPT_per_patient_densities <- ADAPT_per_patient %>% mutate(across(ends_with(\"_S\") & -area_mm2_E & -area_mm2_S & -total_area, ~ .x/area_mm2_S)) %>%\n  mutate(across(ends_with(\"_E\")  & -area_mm2_E & -area_mm2_S & -total_area, ~.x/area_mm2_E))\n\nglimpse(ADAPT_per_patient_densities)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,077\nColumns: 20\n$ pNum             <int> 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ CD3pCD8nPD1n_S   <dbl> 86.368228, 0.000000, 67.667047, 4.944774, 266.199758,…\n$ CD3pCD8nPD1n_E   <dbl> 2.980469, 0.000000, 72.899001, 2.999790, 45.062111, 1…\n$ CD3pCD8nPD1p_S   <dbl> 90.294056, 0.000000, 210.123987, 0.000000, 154.567601…\n$ CD3pCD8nPD1p_E   <dbl> 5.960937, 2.943613, 43.076682, 0.000000, 16.689671, 2…\n$ CD3pCD8pPD1n_S   <dbl> 19.629143, 0.000000, 85.474164, 0.000000, 85.870890, …\n$ CD3pCD8pPD1n_E   <dbl> 0.000000, 11.774451, 49.703864, 0.000000, 11.682769, …\n$ CD3pCD8pPD1p_S   <dbl> 15.703314, 0.000000, 178.071176, 0.000000, 42.935445,…\n$ CD3pCD8pPD1p_E   <dbl> 11.921875, 41.210578, 92.780547, 0.000000, 18.358638,…\n$ CD68nPDL1nPD1p_S <dbl> 125.626513, 0.000000, 523.529257, 9.889549, 51.522534…\n$ CD68nPDL1nPD1p_E <dbl> 8.941406, 2.943613, 79.526183, 2.999790, 11.682769, 2…\n$ area_mm2_S       <dbl> 0.2547233, 0.0083039, 0.2807866, 0.2022337, 0.1164539…\n$ area_mm2_E       <dbl> 0.3355177, 0.3397186, 0.3017874, 0.3333567, 0.5991730…\n$ total_area       <dbl> 0.5902410, 0.3480225, 0.5825740, 0.5355904, 0.7156269…\n$ CD68pPDL1n_S     <dbl> 812.64651, 602.12671, 658.86335, 202.73575, 661.20585…\n$ CD68pPDL1n_E     <dbl> 140.082028, 373.838818, 510.293008, 5.999579, 600.828…\n$ CD68pPDL1p_S     <dbl> 39.258285, 120.425342, 153.141211, 29.668646, 3005.48…\n$ CD68pPDL1p_E     <dbl> 0.000000, 114.800897, 3.313591, 0.000000, 487.338381,…\n$ PDL1pCKp_S       <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.0…\n$ PDL1pCKp_E       <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 1.668967, 0.0…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combine densities dataframes\nCOMBINED_PANEL_INNER_JOIN <- inner_join(ADAPT_per_patient_densities, BT_per_patient_densities, by=\"pNum\", suffix = c(\".ADAPT\", \".BT\"))\n\nCOMBINED_PANEL_INNER_JOIN <- COMBINED_PANEL_INNER_JOIN %>% mutate(BT_str_prop = (area_mm2_S.BT/total_area.BT)*100,\n                                                                  BT_epi_prop = (area_mm2_E.BT/total_area.BT)*100,\n                                                                  ADAPT_epi_prop = (area_mm2_E.ADAPT/total_area.ADAPT)*100,\n                                                                  ADAPT_str_prop = (area_mm2_S.ADAPT/total_area.ADAPT)*100) %>%\n  mutate(avg_str_prop = (BT_str_prop+ADAPT_str_prop)/2,\n         avg_epi_prop = (BT_epi_prop+ADAPT_epi_prop)/2)\n\nglimpse(COMBINED_PANEL_INNER_JOIN)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,064\nColumns: 41\n$ pNum             <int> 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ CD3pCD8nPD1n_S   <dbl> 86.368228, 0.000000, 67.667047, 4.944774, 266.199758,…\n$ CD3pCD8nPD1n_E   <dbl> 2.980469, 0.000000, 72.899001, 2.999790, 45.062111, 1…\n$ CD3pCD8nPD1p_S   <dbl> 90.294056, 0.000000, 210.123987, 0.000000, 154.567601…\n$ CD3pCD8nPD1p_E   <dbl> 5.960937, 2.943613, 43.076682, 0.000000, 16.689671, 2…\n$ CD3pCD8pPD1n_S   <dbl> 19.629143, 0.000000, 85.474164, 0.000000, 85.870890, …\n$ CD3pCD8pPD1n_E   <dbl> 0.000000, 11.774451, 49.703864, 0.000000, 11.682769, …\n$ CD3pCD8pPD1p_S   <dbl> 15.703314, 0.000000, 178.071176, 0.000000, 42.935445,…\n$ CD3pCD8pPD1p_E   <dbl> 11.921875, 41.210578, 92.780547, 0.000000, 18.358638,…\n$ CD68nPDL1nPD1p_S <dbl> 125.626513, 0.000000, 523.529257, 9.889549, 51.522534…\n$ CD68nPDL1nPD1p_E <dbl> 8.941406, 2.943613, 79.526183, 2.999790, 11.682769, 2…\n$ area_mm2_S.ADAPT <dbl> 0.2547233, 0.0083039, 0.2807866, 0.2022337, 0.1164539…\n$ area_mm2_E.ADAPT <dbl> 0.3355177, 0.3397186, 0.3017874, 0.3333567, 0.5991730…\n$ total_area.ADAPT <dbl> 0.5902410, 0.3480225, 0.5825740, 0.5355904, 0.7156269…\n$ CD68pPDL1n_S     <dbl> 812.64651, 602.12671, 658.86335, 202.73575, 661.20585…\n$ CD68pPDL1n_E     <dbl> 140.082028, 373.838818, 510.293008, 5.999579, 600.828…\n$ CD68pPDL1p_S     <dbl> 39.258285, 120.425342, 153.141211, 29.668646, 3005.48…\n$ CD68pPDL1p_E     <dbl> 0.000000, 114.800897, 3.313591, 0.000000, 487.338381,…\n$ PDL1pCKp_S       <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.0…\n$ PDL1pCKp_E       <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 1.668967, 0.0…\n$ CD3pCD8n_E       <dbl> 4.853809, 0.000000, 13.477221, 0.000000, 21.345814, 0…\n$ CD3pCD8n_S       <dbl> 66.296531, 0.000000, 33.670729, 0.000000, 32.648776, …\n$ CD3pCD8nFoxP3p_E <dbl> 12.134523, 22.412659, 124.664291, 0.000000, 40.912811…\n$ CD3pCD8nFoxP3p_S <dbl> 69.310010, 0.000000, 85.299180, 0.000000, 65.297551, …\n$ CD3pCD8p_E       <dbl> 12.134523, 64.036168, 148.249427, 0.000000, 35.576357…\n$ CD3pCD8p_S       <dbl> 24.107829, 10.723389, 141.417062, 5.391478, 124.06534…\n$ area_mm2_E.BT    <dbl> 0.4120475, 0.3123235, 0.2967971, 0.3529410, 0.5621711…\n$ area_mm2_S.BT    <dbl> 0.3318424, 0.0932541, 0.4454908, 0.3709558, 0.1531451…\n$ CD20p_E          <dbl> 0.000000, 3.201808, 6.738610, 0.000000, 3.557636, 0.0…\n$ CD20p_S          <dbl> 0.000000, 10.723389, 4.489431, 0.000000, 0.000000, 0.…\n$ CD3pCD8pFoxP3p_E <dbl> 0.000000, 0.000000, 3.369305, 0.000000, 0.000000, 0.0…\n$ CD3pCD8pFoxP3p_S <dbl> 0.000000, 0.000000, 0.000000, 0.000000, 6.529755, 0.0…\n$ CD79ApCD20n_E    <dbl> 0.000000, 0.000000, 57.278188, 0.000000, 1.778818, 0.…\n$ CD79ApCD20n_S    <dbl> 33.148266, 0.000000, 558.934101, 0.000000, 189.362898…\n$ total_area.BT    <dbl> 0.7438899, 0.4055776, 0.7422879, 0.7238968, 0.7153162…\n$ BT_str_prop      <dbl> 44.60907, 22.99291, 60.01590, 51.24429, 21.40943, 25.…\n$ BT_epi_prop      <dbl> 55.39093, 77.00709, 39.98410, 48.75571, 78.59057, 74.…\n$ ADAPT_epi_prop   <dbl> 56.84419, 97.61398, 51.80241, 62.24098, 83.72701, 78.…\n$ ADAPT_str_prop   <dbl> 43.155813, 2.386024, 48.197585, 37.759023, 16.272991,…\n$ avg_str_prop     <dbl> 43.88244, 12.68947, 54.10675, 44.50166, 18.84121, 23.…\n$ avg_epi_prop     <dbl> 56.11756, 87.31053, 45.89325, 55.49834, 81.15879, 76.…\n```\n:::\n\n```{.r .cell-code}\n#COMBINED_PANEL_INNER_JOIN %>% write.csv(\"../../Final_Data/COMBINED_PANELS_DENSITIES_08NOV22.csv\", row.names = FALSE)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}